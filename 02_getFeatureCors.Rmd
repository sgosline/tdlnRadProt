---
title: "HNSCC Imaging feature correlation"
author: "Sara Gosline"
date: "7/1/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(grid)
library(gridExtra)
```

## Summary
The goal of this analysis is to ascertain the expression of key proteins in the HSNCC dataset that could give rise to imaging features.

```{r load data, echo=FALSE,warning=FALSE}
source("loadHNSCCdata.R")
```
Now that we have the genes and the samples aligned we can begin to analyze them more broadly.


## Compute correlations between genes and imaging features

We now want to see how the patients fall across the various variables. We start by plotting raw tumor abundance, then compute differences between tumor/normal.
```{r pcaplot, echo=FALSE}



##let's first do a PCA plotted with positive lns
tumAbund <- pcaFromDf(fullProts,'inferredTumAbund')%>%
  left_join(clin.dat,by='patient')

##all proteins
ggplot(tumAbund)+
  geom_point(aes(x=PC1,y=PC2,col=ln_examined,size=frac_ln))+
  ggtitle('All proteins tumor expression')

##let's first do a PCA plotted with positive lns
tumNorm <- pcaFromDf(fullProts,'tumNormDiff')%>%
  left_join(clin.dat,by='patient')

##all proteins
ggplot(tumNorm)+
  geom_point(aes(x=PC1,y=PC2,col=ln_examined,size=frac_ln))+
  ggtitle('Tumor vs. normal all proteins')

```


## Selected invasion proteins
Do we see any difference  in clustering/staining with invasivity?

```{r pcaplot2, echo=FALSE}

redProts <- fullProts%>%
  subset(Gene%in%invList$Symbol)

##let's first do a PCA plotted with positive lns
tumAbund <- pcaFromDf(redProts,'inferredTumAbund')%>%
  left_join(clin.dat,by='patient')

##all proteins
ggplot(tumAbund)+
  geom_point(aes(x=PC1,y=PC2,col=ln_examined,size=frac_ln))+
  ggtitle('Invasive proteins tumor expression')

##let's first do a PCA plotted with positive lns
tumNorm <- pcaFromDf(redProts,'tumNormDiff')%>%
  left_join(clin.dat,by='patient')

##all proteins
ggplot(tumNorm)+
  geom_point(aes(x=PC1,y=PC2,col=ln_examined,size=frac_ln))+
  ggtitle('Tumor vs. normal invasive proteins')

```